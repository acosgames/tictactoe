{"version":3,"file":"server.bundle.dev.js","sources":["../../acosgames/dist/server.js","../game-server/game.js","../game-server/index.js"],"sourcesContent":["class ACOSServer {\n    constructor() {\n        this.init = () => {\n            try {\n                this.gameState = JSON.parse(JSON.stringify(game()));\n            }\n            catch (e) {\n                this.error(\"Failed to load gameState\");\n                return;\n            }\n            this.currentAction = null;\n            this.kickedPlayers = [];\n        };\n        this.on = (type, cb) => {\n            let userActions = actions();\n            for (var i = 0; i < userActions.length; i++) {\n                if (userActions[i].type == type) {\n                    this.currentAction = userActions[i];\n                    let result = cb(this.currentAction);\n                    if (typeof result == \"boolean\" && !result) {\n                        ignore();\n                        break;\n                    }\n                }\n            }\n        };\n        this.setGame = (game) => {\n            for (var id in this.gameState.players) {\n                let player = this.gameState.players[id];\n                game.players[id] = player;\n            }\n            this.gameState = game;\n        };\n        this.save = () => {\n            save(this.gameState);\n        };\n        this.gameerror = (payload) => {\n            gameerror(\"[Error]:\", payload);\n            this.events(\"gameerror\", typeof payload === \"undefined\" ? true : payload);\n        };\n        this.gamecancelled = (payload) => {\n            this.events(\"gamecancelled\", typeof payload === \"undefined\" ? true : payload);\n        };\n        this.gameover = (payload) => {\n            this.events(\"gameover\", typeof payload === \"undefined\" ? true : payload);\n        };\n        this.log = (...msg) => {\n            gamelog(...msg);\n        };\n        this.error = (...msg) => {\n            gameerror(...msg);\n        };\n        this.kickPlayer = (id) => {\n            this.kickedPlayers.push(id);\n        };\n        this.randomInt = (min, max) => {\n            min = Math.ceil(min);\n            max = Math.floor(max);\n            return Math.floor(random() * (max - min) + min);\n        };\n        this.action = () => {\n            return this.currentAction;\n        };\n        this.gamestate = () => {\n            return this.gameState;\n        };\n        this.playerList = () => Object.keys(this.gameState.players);\n        this.playerCount = () => Object.keys(this.gameState.players).length;\n        this.setTimer = (seconds) => {\n            seconds = seconds || 15;\n            this.gameState.timer.set = seconds;\n        };\n        this.reachedTimelimit = (action) => {\n            if (typeof action.timeleft == \"undefined\")\n                return false;\n            return action.timeleft <= 0;\n        };\n        this.clearEvents = () => {\n            this.gameState.events = {};\n        };\n    }\n    ignore() {\n        ignore();\n    }\n    random() {\n        return random();\n    }\n    database() {\n        return database();\n    }\n    room(key, value) {\n        if (typeof key === \"undefined\")\n            return this.gameState.room;\n        if (typeof value === \"undefined\")\n            return this.gameState.room[key];\n        this.gameState.room[key] = value;\n        return value;\n    }\n    state(key, value) {\n        if (typeof key === \"undefined\")\n            return this.gameState.state;\n        if (typeof value === \"undefined\")\n            return this.gameState.state[key];\n        this.gameState.state[key] = value;\n        return value;\n    }\n    players(shortid, value) {\n        if (typeof shortid === \"undefined\")\n            return this.gameState.players;\n        if (typeof value === \"undefined\")\n            return this.gameState.players[shortid];\n        this.gameState.players[shortid] = value;\n        return value;\n    }\n    statIncrement(shortid, abbreviation, value) {\n        let player = this.players(shortid);\n        if (typeof player.stats === \"undefined\") {\n            player.stats = {};\n        }\n        value = value || 1;\n        if (typeof player.stats[abbreviation] === \"undefined\")\n            player.stats[abbreviation] = value;\n        else\n            player.stats[abbreviation] =\n                player.stats[abbreviation] + value;\n        return player.stats[abbreviation];\n    }\n    stats(shortid, abbreviation, value) {\n        let player = this.players(shortid);\n        if (typeof player.stats === \"undefined\") {\n            player.stats = {};\n        }\n        if (typeof value === \"undefined\")\n            return player.stats[abbreviation];\n        if (typeof value == \"string\") {\n            let obj = player.stats[abbreviation];\n            if (!obj)\n                obj = {};\n            if (value in obj)\n                obj[value] += 1;\n            else\n                obj[value] = 1;\n            player.stats[abbreviation] = obj;\n        }\n        else\n            player.stats[abbreviation] = value;\n        return player.stats[abbreviation];\n    }\n    teams(teamid, value) {\n        if (typeof teamid === \"undefined\")\n            return this.gameState.teams;\n        if (typeof value === \"undefined\")\n            return this.gameState.teams[teamid];\n        this.gameState.teams[teamid] = value;\n    }\n    next(id, action) {\n        if (typeof id !== \"undefined\") {\n            this.gameState.next = { id, action };\n        }\n        return this.gameState.next;\n    }\n    timer() {\n        return this.gameState.timer;\n    }\n    events(name, payload) {\n        if (typeof name === \"undefined\")\n            return this.gameState.events;\n        if (typeof payload === \"undefined\")\n            return this.gameState.events[name];\n        this.gameState.events[name] = payload;\n        return this.gameState.events[name];\n    }\n}\nexport default new ACOSServer();\n//# sourceMappingURL=server.js.map","import { ACOSServer } from \"acosgames\";\r\n\r\nconst defaultBoard = [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"];\r\n\r\nexport function onNewGame(action) {\r\n    let state = ACOSServer.state();\r\n    state.cells = defaultBoard;\r\n\r\n    //select the starting player\r\n    let team = ACOSServer.teams(\"team_x\");\r\n    let shortid = team.players[0];\r\n\r\n    ACOSServer.next(shortid, \"pick\");\r\n    ACOSServer.events(\"newround\", true);\r\n    ACOSServer.setTimer(15);\r\n}\r\n\r\nexport function onJoin(action) {\r\n    ACOSServer.log(action);\r\n    if (!action.user.shortid) return;\r\n\r\n    let player = ACOSServer.players(action.user.shortid);\r\n    player.rank = 2;\r\n    player.score = 0;\r\n\r\n    let teams = ACOSServer.teams();\r\n    if (teams && player.teamid) {\r\n        teams[player.teamid].rank = 2;\r\n        teams[player.teamid].score = 0;\r\n    }\r\n\r\n    ACOSServer.log(\"TICTACTOE PLAYER INFO:\");\r\n    ACOSServer.log(player);\r\n\r\n    ACOSServer.players(action.user.shortid, player);\r\n\r\n    let playerCount = ACOSServer.playerCount();\r\n    if (playerCount <= 2) {\r\n        ACOSServer.events(\"join\", {\r\n            shortid: action.user.shortid,\r\n        });\r\n    }\r\n}\r\n\r\nexport function onSkip(action) {\r\n    let next = ACOSServer.next();\r\n    if (!next || !next.id) return;\r\n\r\n    playerLeave(next.id);\r\n}\r\n\r\nexport function onLeave(action) {\r\n    playerLeave(action.user.shortid);\r\n}\r\n\r\nlet cellToName = [\r\n    \"Top Left\",\r\n    \"Top Middle\",\r\n    \"Top Right\",\r\n    \"Middle Left\",\r\n    \"Middle\",\r\n    \"Middle Right\",\r\n    \"Bottom Left\",\r\n    \"Bottom Middle\",\r\n    \"Bottom Right\",\r\n];\r\n\r\nexport function onPick(action) {\r\n    let state = ACOSServer.state();\r\n    let player = ACOSServer.players(action.user.shortid);\r\n\r\n    //get the picked cell\r\n    let cellid = action.payload;\r\n    if (\r\n        typeof cellid !== \"number\" ||\r\n        cellid < 0 ||\r\n        cellid >= state.cells.length\r\n    )\r\n        return false;\r\n\r\n    // block picking cells with markings, and send error\r\n    let cell = state.cells[cellid];\r\n    if (cell.length > 0) {\r\n        player._error = \"Square is not empty!\";\r\n        return true;\r\n    }\r\n\r\n    //mark the selected cell\r\n    let teamType = getTeamType(player.teamid);\r\n    if (!state.cells.includes(teamType)) {\r\n        ACOSServer.stats(action.user.shortid, \"FP\", cellToName[cellid]);\r\n    }\r\n    state.cells[cellid] = teamType;\r\n\r\n    let timer = ACOSServer.timer();\r\n\r\n    ACOSServer.statIncrement(action.user.shortid, \"P\");\r\n\r\n    ACOSServer.statIncrement(action.user.shortid, \"F\");\r\n    ACOSServer.statIncrement(action.user.shortid, \"A\");\r\n    ACOSServer.statIncrement(action.user.shortid, \"T\", action.timeleft / 1000);\r\n\r\n    if (checkWinner()) {\r\n        if (state.cells.includes(teamType)) {\r\n            ACOSServer.stats(action.user.shortid, \"WP\", cellToName[cellid]);\r\n        }\r\n        return;\r\n    }\r\n\r\n    ACOSServer.setTimer(15);\r\n    selectNextPlayer(action.user.shortid);\r\n}\r\n\r\nfunction getTeamType(teamid) {\r\n    return teamid == \"team_x\" ? \"X\" : \"O\";\r\n}\r\n\r\nfunction playerLeave(shortid) {\r\n    let players = ACOSServer.players();\r\n    let otherPlayerId = null;\r\n    if (players[shortid]) {\r\n        otherPlayerId = selectNextPlayer(shortid);\r\n        let otherPlayer = players[otherPlayerId];\r\n        setWinner(otherPlayer.teamid, \"forfeit\");\r\n    }\r\n}\r\n\r\nfunction selectNextPlayer(shortid) {\r\n    //only 2 players so just filter the current player\r\n    let playerList = ACOSServer.playerList();\r\n    shortid = playerList.filter((x) => x != shortid)[0];\r\n    ACOSServer.next(shortid, \"pick\");\r\n    return shortid;\r\n}\r\n\r\n// Check each strip that makes a win\r\n//      0  |  1  |  2\r\n//    -----------------\r\n//      3  |  4  |  5\r\n//    -----------------\r\n//      6  |  7  |  8\r\nfunction checkWinner() {\r\n    if (check([0, 1, 2])) return true;\r\n    if (check([3, 4, 5])) return true;\r\n    if (check([6, 7, 8])) return true;\r\n    if (check([0, 3, 6])) return true;\r\n    if (check([1, 4, 7])) return true;\r\n    if (check([2, 5, 8])) return true;\r\n    if (check([0, 4, 8])) return true;\r\n    if (check([6, 4, 2])) return true;\r\n    if (checkBoardFilled()) return true;\r\n    return false;\r\n}\r\n\r\nfunction checkBoardFilled() {\r\n    let cells = ACOSServer.state().cells;\r\n    let filtered = cells.filter((v) => v == \"\");\r\n\r\n    if (filtered.length == 0) {\r\n        setTie();\r\n    }\r\n    return filtered.length == 0;\r\n}\r\n\r\n// checks if a strip has matching types\r\nfunction check(strip) {\r\n    let cells = ACOSServer.state().cells;\r\n    let first = cells[strip[0]];\r\n    if (first == \"\") return false;\r\n    let filtered = strip.filter((id) => cells[id] == first);\r\n    if (filtered.length == 3 && filtered.length == strip.length) {\r\n        setWinner(first == \"X\" ? \"team_x\" : \"team_o\", strip);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction findPlayerWithType(teamid) {\r\n    let team = ACOSServer.teams(teamid);\r\n    return team.players[0];\r\n}\r\n\r\nfunction setTie() {\r\n    ACOSServer.gameover({ type: \"tie\" });\r\n    ACOSServer.next(\"none\");\r\n}\r\n\r\n// set the winner event and data\r\nfunction setWinner(teamid, strip) {\r\n    //find user who matches the win type\r\n    let shortid = findPlayerWithType(teamid);\r\n    let player = ACOSServer.players(shortid);\r\n\r\n    let team = ACOSServer.teams(player.teamid);\r\n    if (team) {\r\n        team.rank = 1;\r\n        team.score = 100;\r\n    }\r\n    player.rank = 1;\r\n    player.score = player.score + 100;\r\n\r\n    if (strip == \"forfeit\") ACOSServer.gameerror(\"Player left early.\");\r\n    else\r\n        ACOSServer.gameover({\r\n            type: \"winner\",\r\n            pick: teamid,\r\n            strip: strip,\r\n            shortid: shortid,\r\n        });\r\n}\r\n","import { ACOSServer } from \"acosgames\";\r\n\r\nimport { onJoin, onLeave, onNewGame, onPick, onSkip } from \"./game\";\r\n\r\n//prepare gameState for mutation\r\nACOSServer.init();\r\n\r\n//ACOS events\r\nACOSServer.on(\"gamestart\", onNewGame);\r\nACOSServer.on(\"join\", onJoin);\r\nACOSServer.on(\"leave\", onLeave);\r\nACOSServer.on(\"skip\", onSkip);\r\n\r\n//Custom events\r\nACOSServer.on(\"pick\", onPick);\r\n\r\n//Save changes\r\nACOSServer.save();\r\n"],"names":["ACOSServer"],"mappings":"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"}